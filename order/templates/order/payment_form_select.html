{% extends "shared/layout.html" %} 
{% block content %} 
<body class="font-sans bg-blue-900">
<div class="font-sans bg-blue-900" data-page="switching_tab_payment">
  <div class="container mx-auto py-10 px-[10%]">
    <!-- 回上一頁按鈕 -->
    <div class="mb-4">
      <a
        class="px-4 py-2 font-bold text-white bg-gray-400 rounded hover:bg-gray-500"
        href="javascript:history.back()"
      >
        上一頁
      </a>
    </div>

    <div class="flex p-6 overflow-hidden bg-white rounded-lg shadow-lg">
      <!-- 左側內容 -->
      <div class="w-1/2">
        <h1 class="mb-6 text-2xl font-bold text-gray-800">選擇支付方式</h1>

        <form method="POST" action="{% url 'order:create_order' %}">
          {% csrf_token %}
          <!-- 隱藏的服務 ID -->
          <input type="hidden" name="service_id" value="{{ service.id }}">
          <input type="hidden" name="plan" value="{{ selected_plan }}">
          <!-- 方案選擇 -->
          <div class="mb-6">
              <label for="plan" class="block mb-2 font-medium text-gray-900">方案</label>
              <select
                  id="plan"
                  name="plan"
                  class="w-full p-3 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  onchange="togglePlanView(this.value)"
              >
                  <option value="standard" {% if selected_plan == "standard" %}selected{% endif %}>
                      一般方案
                  </option>
                  <option value="premium" {% if selected_plan == "premium" %}selected{% endif %}>
                      專業方案
                  </option>
              </select>
          </div>
      
          <!-- 支付方式 -->
          <div class="mb-6">
              <label for="payment-method" class="block mb-2 font-medium text-gray-900">支付方式</label>
              <select
                  id="payment_method"
                  name="payment_method"
                  class="w-full p-3 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                  <option value="" disabled selected>請選擇</option>
                  <option value="credit_card">信用卡(20萬以下)</option>
                  <option value="atm">ATM 轉帳(5萬以下)</option>
                  <option value="linepay">Line Pay</option>
                  {% comment %} <option value="googlepay">Google Pay</option> {% endcomment %}
                  <option value="barcode">超商條碼(2萬以下)</option>
              </select>
          </div>
      
          <!-- 購買須知 -->
          <div class="flex items-center mb-4">
              <input
                  type="checkbox"
                  id="terms"
                  name="terms"
                  class="w-4 h-4 bg-white border border-blue-700 rounded appearance-none checked:bg-blue-900 checked:border-blue-300 focus:ring-2 focus:ring-blue-200"
                  onclick="toggleSubmitButtonAndDisplayPlan()"
              />
              <label for="terms" class="ml-2 text-gray-700">
                  我已閱讀並同意購買須知。
              </label>
              <button
                  type="button"
                  class="ml-4 text-blue-500 underline focus:outline-none"
                  onclick="showTerms()"
              >
                  點我閱讀
              </button>
          </div>
      
          <!-- 按鈕區域 -->
          <div class="flex justify-between mb-4">
              <button
                  type="button"
                  class="px-4 py-2 font-semibold text-white bg-gray-400 rounded-lg hover:bg-gray-500 focus:outline-none focus:shadow-outline"
                  onclick="history.back();"
              >
                  上一步
              </button>
              <button
                  type="submit"
                  class="px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:shadow-outline"
                  id="nextButton"
                  disabled
              >
                  下一步
              </button>
          </div>
      </form>
      
      </div>

      <!-- 右側價格一般&專業方案 -->
      <div class="w-1/2 p-6 border-l bg-gray-50">
        <div id="price-section">
          <!-- Standard Plan -->
          <div id="standard" class="block">
            <p class="mb-2 text-4xl font-bold text-gray-800">${{service.standard_price}}</p>
            <p class="mb-4 text-gray-600">
              一般版：{{service.standard_description}} 
            </p>
            <p class="mb-4 text-sm text-red-500">交付時間：{{service.standard_delivery_time}} 天</p>
          </div>
          <!-- Premium Plan -->
          <div id="premium" class="hidden">
            <p class="mb-2 text-4xl font-bold text-gray-800">${{service.premium_price}}</p>
            <p class="mb-4 text-gray-600">
              專業版：{{service.premium_description}} 
            </p>
            <p class="mb-4 text-sm text-red-500">交付時間：{{service.premium_delivery_time}} 天</p>
          </div>
          <!-- Terms and Conditions -->
          <div id="terms-section" class="hidden">
            <h2 class="mb-4 text-2xl font-bold text-gray-800">購買須知</h2>
            <p class="text-gray-700">
              感謝您選擇三合Trico作為您的接案與服務交易平台！在進行交易前，請詳細閱讀並同意以下購買須知：
              <br><br>
              1. **平台角色與責任**：三合Trico僅提供接案者與服務購買者之間的交易媒介，平台不參與交易內容，也不對交易過程中的任何糾紛負法律責任。
              <br>
              2. **服務交易流程**：請在購買前仔細閱讀服務提供者的描述與條款，並與接案者充分溝通。
              <br>
              3. **付款與安全**：所有交易均需通過平台的安全付款系統完成，平台不支持私下交易。
              <br>
              4. **退款與爭議處理**：若對服務不滿意，請於服務完成後5日內通過平台提交爭議申請，我們將協助進行仲裁。
            </p>
            <p class="mt-3 font-bold text-center text-red-600">
              (請先閱讀完畢再勾選左側我已閱讀並同意購買須知。)
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
{% endblock %}
